<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Infinity Team - Premium Social Media Services</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
  :root {
    --primary: #00d8ff;
    --primary-dark: #00b3cc;
    --secondary: #142d4c;
    --dark: #0f2027;
    --accent: #ff4d6d;
    --success: #06d6a0;
    --text: #ffffff;
    --text-light: #a0d8ffcc;
  }
  body {
    margin: 0; padding: 0;
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    color: var(--text);
    min-height: 100vh;
    display: flex; flex-direction: column;
    position: relative;
  }
  .container {
    padding: 20px;
    flex: 1;
    display: flex; flex-direction: column; align-items: center;
  }
  header {
    display: flex; align-items: center; gap: 15px;
    margin-bottom: 25px;
    padding-top: 15px;
  }
  header img {
    width: 60px; height: 60px;
  }
  header h1 {
    font-weight: 700;
    font-size: 2.2rem;
    color: var(--primary);
    margin: 0;
    user-select: none;
    letter-spacing: 1px;
  }
  .tagline {
    color: var(--text-light);
    font-size: 0.9rem;
    margin-top: -15px;
    margin-bottom: 25px;
    text-align: center;
  }

  form {
    background: var(--secondary);
    border-radius: 16px;
    padding: 25px 30px;
    width: 100%;
    max-width: 750px;
    box-shadow: 0 10px 30px rgba(0,216,255,0.4);
    margin-bottom: 30px;
  }
  .category-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(280px,1fr));
    gap: 20px;
  }
  .category-card {
    background: #1f4068;
    border-radius: 12px;
    padding: 20px;
    box-shadow: inset 0 0 10px #00d8ff88;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: all 0.3s ease;
    cursor: default;
    position: relative;
  }
  .category-card:hover {
    background: #00d8ff22;
    transform: translateY(-3px);
  }
  .badge {
    position: absolute;
    top: 10px;
    right: 10px;
    color: white;
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 0.7rem;
    font-weight: bold;
  }
  .limited-badge {
    background: var(--accent);
  }
  .guaranteed-badge {
    background: var(--success);
  }
  .category-icon {
    font-size: 48px;
    margin-bottom: 12px;
  }
  .category-title {
    font-weight: 700;
    font-size: 1.25rem;
    margin-bottom: 6px;
  }
  .category-desc {
    font-size: 0.9rem;
    color: var(--text-light);
    text-align: center;
    margin-bottom: 15px;
    line-height: 1.4;
  }
  .category-price {
    font-weight: 700;
    color: var(--primary);
    margin-bottom: 10px;
  }
  .category-note {
    font-size: 0.8rem;
    text-align: center;
    margin-top: 5px;
    font-style: italic;
  }
  .note-warning {
    color: var(--accent);
  }
  .note-success {
    color: var(--success);
  }
  label {
    font-weight: 600;
    margin-bottom: 6px;
    display: block;
  }
  input[type="number"] {
    width: 80px;
    font-size: 1.1rem;
    border-radius: 8px;
    border: none;
    padding: 8px;
    text-align: center;
    outline: none;
    box-shadow: 0 0 5px #00d8ffaa;
    background: #112b4a;
    color: #e0f7ff;
    -moz-appearance: textfield;
  }
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  /* Name input */
  .name-group {
    margin-bottom: 30px;
  }
  .name-group label {
    font-size: 1.1rem;
    display: block;
    margin-bottom: 8px;
  }
  .name-group input {
    width: 100%;
    font-size: 1.1rem;
    border-radius: 10px;
    border: none;
    padding: 12px 15px;
    box-shadow: 0 0 10px #00d8ffaa inset;
    background: #112b4a;
    color: #e0f7ff;
  }
  .name-group input:focus {
    outline: none;
    box-shadow: 0 0 12px #00f0ffcc inset;
  }
  
  /* Contact info section */
  .contact-group {
    margin-bottom: 30px;
  }
  .contact-group label {
    font-size: 1.1rem;
    display: block;
    margin-bottom: 8px;
  }
  .contact-group input {
    width: 100%;
    font-size: 1.1rem;
    border-radius: 10px;
    border: none;
    padding: 12px 15px;
    box-shadow: 0 0 10px #00d8ffaa inset;
    background: #112b4a;
    color: #e0f7ff;
    margin-bottom: 15px;
  }
  .contact-group input:focus {
    outline: none;
    box-shadow: 0 0 12px #00f0ffcc inset;
  }
  .contact-note {
    font-size: 0.85rem;
    color: var(--text-light);
    margin-top: -10px;
    margin-bottom: 10px;
  }
  
  /* Custom order section */
  .custom-order {
    margin: 25px 0;
    padding: 20px;
    background: rgba(0,216,255,0.1);
    border-radius: 12px;
    border: 1px dashed var(--primary);
  }
  .custom-order h3 {
    margin-top: 0;
    color: var(--primary);
    text-align: center;
  }
  .custom-order textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border-radius: 8px;
    background: #112b4a;
    color: white;
    border: 1px solid var(--primary);
    margin-bottom: 10px;
  }
  
  /* Terms checkbox */
  .terms-group {
    margin: 25px 0;
    padding: 15px;
    background: rgba(255,77,109,0.1);
    border-radius: 8px;
  }
  .terms-group label {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 0.9rem;
    cursor: pointer;
  }
  .terms-group input[type="checkbox"] {
    margin-top: 3px;
  }
  .terms-text {
    font-size: 0.85rem;
    color: var(--text-light);
  }
  .terms-text strong {
    color: var(--accent);
  }
  
  button {
    background: var(--primary);
    border: none;
    padding: 16px 0;
    font-size: 1.3rem;
    font-weight: 700;
    width: 100%;
    border-radius: 14px;
    cursor: pointer;
    color: #022b3a;
    box-shadow: 0 6px 20px #00d8ffaa;
    transition: all 0.3s ease;
  }
  button:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
  }
  .info-text {
    font-size: 0.85rem;
    margin-top: 6px;
    color: var(--text-light);
    text-align: center;
  }
  
  /* Footer */
  footer {
    background: rgba(0,0,0,0.3);
    padding: 20px;
    text-align: center;
    font-size: 0.9rem;
    color: var(--text-light);
    margin-top: auto;
  }
  .footer-links {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 15px;
  }
  .footer-links a {
    color: var(--primary);
    text-decoration: none;
    transition: color 0.3s;
  }
  .footer-links a:hover {
    color: var(--text);
  }
  .copyright {
    font-size: 0.8rem;
  }

  /* Modal */
  .modal-bg {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
  }
  .modal-bg.active {
    opacity: 1;
    pointer-events: all;
  }
  .modal {
    background: var(--secondary);
    border-radius: 16px;
    max-width: 450px;
    width: 90%;
    padding: 30px 25px;
    box-shadow: 0 10px 25px #00d8ffbb;
    text-align: center;
    color: #c0f0ff;
    position: relative;
  }
  .modal h3 {
    margin-top: 0;
    margin-bottom: 20px;
    font-weight: 700;
    color: var(--primary);
  }
  .modal p {
    font-size: 1rem;
    margin-bottom: 30px;
    line-height: 1.5;
  }
  .modal-buttons {
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  .modal button {
    width: 45%;
    margin: 0;
    padding: 12px 0;
    font-size: 1.1rem;
    border-radius: 12px;
    box-shadow: none;
  }
  .modal button.confirm {
    background: var(--primary);
    color: #022b3a;
  }
  .modal button.cancel {
    background: #555;
    color: #eee;
  }

  /* Welcome Popup */
  .welcome-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--secondary);
    border-radius: 16px;
    max-width: 500px;
    width: 90%;
    padding: 30px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    z-index: 1001;
    text-align: center;
    display: none;
  }
  .welcome-popup.active {
    display: block;
  }
  .welcome-popup h2 {
    color: var(--primary);
    margin-top: 0;
  }
  .welcome-popup p {
    line-height: 1.6;
    margin-bottom: 25px;
  }
  .welcome-popup .close-btn {
    background: var(--primary);
    color: #022b3a;
    border: none;
    padding: 12px 25px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: background 0.3s;
  }
  .welcome-popup .close-btn:hover {
    background: var(--primary-dark);
  }
  .popup-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.8);
    z-index: 1000;
    display: none;
  }
  .popup-overlay.active {
    display: block;
  }

  /* Validation styles */
  .error-message {
    color: var(--accent);
    font-size: 0.8rem;
    margin-top: 5px;
    display: none;
  }
  .input-error {
    box-shadow: 0 0 5px var(--accent) !important;
    border: 1px solid var(--accent) !important;
  }

  /* Responsive */
  @media (max-width: 768px) {
    header h1 {
      font-size: 1.8rem;
    }
    form {
      padding: 20px 15px;
    }
    .category-grid {
      grid-template-columns: 1fr;
    }
    .footer-links {
      flex-direction: column;
      gap: 10px;
    }
    .modal-buttons {
      flex-direction: column;
    }
    .modal button {
      width: 100%;
    }
  }
  @media (max-width: 480px) {
    input[type="number"] {
      width: 60px;
    }
  }
</style>
<!-- Icons CDN -->
<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  rel="stylesheet"
/>
</head>
<body>

<!-- Welcome Popup -->
<div class="popup-overlay" id="popupOverlay"></div>
<div class="welcome-popup" id="welcomePopup">
  <h2>Welcome to Infinity Tech Zone</h2>
  <p>Thank you for choosing our premium social media growth services. We offer both guaranteed and non-guaranteed options to suit your needs and budget.</p>
  <p><strong>Important:</strong> All orders are final and cannot be canceled once placed. Spam or fraudulent orders will be reported to authorities.</p>
  <button class="close-btn" id="closePopupBtn">I Understand - Continue</button>
</div>

<div class="container">
  <header>
    <img src="https://i.imgur.com/1tR1X6O.png" alt="Infinity Team Logo" />
    <div>
      <h1>Infinity Team</h1>
      <div class="tagline">Premium Social Media Services | Part of Infinity Tech Zone</div>
    </div>
  </header>

  <form id="orderForm" novalidate>
    <div class="name-group">
      <label for="name">Your Full Name <span style="color:var(--accent);">*</span></label>
      <input type="text" id="name" name="name" placeholder="Kasun Perera" required />
      <div id="nameError" class="error-message">Please enter your full name (minimum 3 characters)</div>
    </div>

    <div class="contact-group">
      <label for="email">Email Address <span style="color:var(--accent);">*</span></label>
      <input type="email" id="email" name="email" placeholder="yourname@example.com" required />
      <div id="emailError" class="error-message">Please enter a valid email address</div>
      <div class="contact-note">This will be used for order confirmation and communication</div>

      <label for="phone">Phone Number <span style="color:var(--accent);">*</span></label>
      <input type="tel" id="phone" name="phone" placeholder="94712345678" required />
      <div id="phoneError" class="error-message">Please enter a valid 10-digit phone number</div>
      <div class="contact-note">Include country code (e.g., 94 for Sri Lanka)</div>
    </div>

    <div class="category-grid">
      <div class="category-card" tabindex="0" aria-label="YouTube Subscribers Package">
        <i class="fa-brands fa-youtube category-icon" style="color:#ff0000;"></i>
        <div class="category-title">YouTube Subscribers</div>
        <div class="category-price">Rs. 850 per 1K</div>
        <div class="category-desc">High-quality, active subscribers<br/>30-day refill guarantee<br/>No drops, safe for your channel</div>
        <label for="ytSubs">Quantity (1K packs)</label>
        <input type="number" id="ytSubs" name="ytSubs" min="0" step="1" value="0" />
        <div id="ytSubsError" class="error-message">Quantity must be 0 or higher</div>
      </div>

      <div class="category-card" tabindex="0" aria-label="TikTok Followers (Non-Guaranteed)">
        <div class="badge limited-badge">LIMITED STOCK</div>
        <i class="fa-brands fa-tiktok category-icon" style="color:#69c9d0;"></i>
        <div class="category-title">TikTok Followers (Basic)</div>
        <div class="category-price">Rs. 450 per 1K</div>
        <div class="category-desc">Standard quality followers<br/>No refill guarantee<br/>May drop over time</div>
        <div class="category-note note-warning">Not guaranteed - for budget options only</div>
        <label for="ttFollowersBasic">Quantity (1K packs)</label>
        <input type="number" id="ttFollowersBasic" name="ttFollowersBasic" min="0" step="1" value="0" />
        <div id="ttFollowersBasicError" class="error-message">Quantity must be 0 or higher</div>
      </div>

      <div class="category-card" tabindex="0" aria-label="TikTok Followers (Guaranteed)">
        <div class="badge guaranteed-badge">GUARANTEED</div>
        <i class="fa-brands fa-tiktok category-icon" style="color:#25f4ee;"></i>
        <div class="category-title">TikTok Followers (Premium)</div>
        <div class="category-price">Rs. 750 per 1K</div>
        <div class="category-desc">High-quality followers<br/>30-day no-drop guarantee<br/>Active accounts</div>
        <div class="category-note note-success">Recommended for best results</div>
        <label for="ttFollowersPremium">Quantity (1K packs)</label>
        <input type="number" id="ttFollowersPremium" name="ttFollowersPremium" min="0" step="1" value="0" />
        <div id="ttFollowersPremiumError" class="error-message">Quantity must be 0 or higher</div>
      </div>

      <div class="category-card" tabindex="0" aria-label="TikTok Views Package">
        <i class="fa-solid fa-eye category-icon" style="color:#ffd166;"></i>
        <div class="category-title">TikTok Views</div>
        <div class="category-price">From Rs. 300</div>
        <div class="category-desc">10K views: Rs. 300<br/>100K views: Rs. 350<br/>Custom packages available</div>
        <label for="ttViews">Quantity (10K packs)</label>
        <input type="number" id="ttViews" name="ttViews" min="0" step="1" value="0" />
        <div id="ttViewsError" class="error-message">Quantity must be 0 or higher</div>
      </div>
    </div>

    <div class="custom-order">
      <h3><i class="fas fa-star"></i> Custom Order Request</h3>
      <p>Need a custom package or different service? Describe your requirements below:</p>
      <textarea id="customOrder" name="customOrder" placeholder="E.g.: Instagram followers, YouTube views, custom TikTok package, etc."></textarea>
      <p class="info-text">We'll contact you with pricing and details within 24 hours</p>
    </div>

    <div class="terms-group">
      <label>
        <input type="checkbox" id="agreeTerms" name="agreeTerms" required />
        <span class="terms-text">
          <strong>I agree to all terms:</strong> By placing this order, I confirm this is a legitimate purchase. 
          All orders are FINAL and cannot be canceled or refunded. Spam or fraudulent orders will be reported 
          to authorities. I understand that basic TikTok followers (Rs. 450) are not guaranteed and may drop.
        </span>
      </label>
      <div id="termsError" class="error-message">You must agree to the terms and conditions</div>
    </div>

    <button type="submit" aria-label="Submit and confirm order">
      <i class="fas fa-lock"></i> Submit Secure Order
    </button>
  </form>
</div>

<footer>
  <div class="footer-links">
    <a href="#" target="_blank">Terms of Service</a>
    <a href="#" target="_blank">Privacy Policy</a>
    <a href="#" target="_blank">Contact Support</a>
    <a href="#" target="_blank">Infinity Tech Zone</a>
  </div>
  <div class="copyright">
    &copy; 2023 Infinity Tech Zone. All orders are final. Unauthorized use prohibited.
  </div>
</footer>

<!-- Modal Confirmation -->
<div class="modal-bg" id="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc">
  <div class="modal">
    <h3 id="modalTitle">Final Order Confirmation</h3>
    <p id="modalDesc">By proceeding, you agree this is a binding order that cannot be canceled. Spam orders will be reported. Press WhatsApp button to send your order details.</p>
    <div class="modal-buttons">
      <button class="confirm" id="confirmBtn">
        <i class="fab fa-whatsapp"></i> Send via WhatsApp
      </button>
      <button class="cancel" id="cancelBtn">Review Order</button>
    </div>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>

<script>
  // Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyBhaGf6Kj04H55v6Fzm5GzI9AlgDOEEL3w",
    authDomain: "infinitysocial-lk.firebaseapp.com",
    projectId: "infinitysocial-lk",
    storageBucket: "infinitysocial-lk.appspot.com",
    messagingSenderId: "932078808154",
    appId: "1:932078808154:web:0a7aec6c918d650045fc63",
    measurementId: "G-ZVY9H3XSNJ",
    databaseURL: "https://infinitysocial-lk-default-rtdb.asia-southeast1.firebasedatabase.app"
  };

  // Initialize Firebase
  const app = firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  // Welcome Popup
  const welcomePopup = document.getElementById('welcomePopup');
  const popupOverlay = document.getElementById('popupOverlay');
  const closePopupBtn = document.getElementById('closePopupBtn');
  
  // Show popup on page load
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
      welcomePopup.classList.add('active');
      popupOverlay.classList.add('active');
    }, 500);
  });
  
  // Close popup
  closePopupBtn.addEventListener('click', function() {
    welcomePopup.classList.remove('active');
    popupOverlay.classList.remove('active');
  });

  // Order Form
  const form = document.getElementById('orderForm');
  const modal = document.getElementById('modal');
  const confirmBtn = document.getElementById('confirmBtn');
  const cancelBtn = document.getElementById('cancelBtn');
  const agreeTerms = document.getElementById('agreeTerms');

  // Error messages
  const nameError = document.getElementById('nameError');
  const emailError = document.getElementById('emailError');
  const phoneError = document.getElementById('phoneError');
  const ytSubsError = document.getElementById('ytSubsError');
  const ttFollowersBasicError = document.getElementById('ttFollowersBasicError');
  const ttFollowersPremiumError = document.getElementById('ttFollowersPremiumError');
  const ttViewsError = document.getElementById('ttViewsError');
  const termsError = document.getElementById('termsError');

  let whatsappUrl = '';
  let orderData = {};

  // Validation functions
  function validateName() {
    const name = form.name.value.trim();
    if (name.length < 3) {
      form.name.classList.add('input-error');
      nameError.style.display = 'block';
      return false;
    }
    form.name.classList.remove('input-error');
    nameError.style.display = 'none';
    return true;
  }

  function validateEmail() {
    const email = form.email.value.trim();
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
      form.email.classList.add('input-error');
      emailError.style.display = 'block';
      return false;
    }
    form.email.classList.remove('input-error');
    emailError.style.display = 'none';
    return true;
  }

  function validatePhone() {
    const phone = form.phone.value.trim();
    const phoneRegex = /^[0-9]{9,12}$/; // Basic phone validation (9-12 digits)
    if (!phoneRegex.test(phone)) {
      form.phone.classList.add('input-error');
      phoneError.style.display = 'block';
      return false;
    }
    form.phone.classList.remove('input-error');
    phoneError.style.display = 'none';
    return true;
  }

  function validateQuantities() {
    let valid = true;
    const ytSubs = parseInt(form.ytSubs.value) || 0;
    const ttFollowersBasic = parseInt(form.ttFollowersBasic.value) || 0;
    const ttFollowersPremium = parseInt(form.ttFollowersPremium.value) || 0;
    const ttViews = parseInt(form.ttViews.value) || 0;

    if (ytSubs < 0) {
      form.ytSubs.classList.add('input-error');
      ytSubsError.style.display = 'block';
      valid = false;
    } else {
      form.ytSubs.classList.remove('input-error');
      ytSubsError.style.display = 'none';
    }

    if (ttFollowersBasic < 0) {
      form.ttFollowersBasic.classList.add('input-error');
      ttFollowersBasicError.style.display = 'block';
      valid = false;
    } else {
      form.ttFollowersBasic.classList.remove('input-error');
      ttFollowersBasicError.style.display = 'none';
    }

    if (ttFollowersPremium < 0) {
      form.ttFollowersPremium.classList.add('input-error');
      ttFollowersPremiumError.style.display = 'block';
      valid = false;
    } else {
      form.ttFollowersPremium.classList.remove('input-error');
      ttFollowersPremiumError.style.display = 'none';
    }

    if (ttViews < 0) {
      form.ttViews.classList.add('input-error');
      ttViewsError.style.display = 'block';
      valid = false;
    } else {
      form.ttViews.classList.remove('input-error');
      ttViewsError.style.display = 'none';
    }

    return valid;
  }

  function validateTerms() {
    if (!agreeTerms.checked) {
      termsError.style.display = 'block';
      return false;
    }
    termsError.style.display = 'none';
    return true;
  }

  // Real-time validation
  form.name.addEventListener('blur', validateName);
  form.email.addEventListener('blur', validateEmail);
  form.phone.addEventListener('blur', validatePhone);
  form.ytSubs.addEventListener('blur', validateQuantities);
  form.ttFollowersBasic.addEventListener('blur', validateQuantities);
  form.ttFollowersPremium.addEventListener('blur', validateQuantities);
  form.ttViews.addEventListener('blur', validateQuantities);
  agreeTerms.addEventListener('change', validateTerms);

  form.addEventListener('submit', function(e) {
    e.preventDefault();

    // Validate all fields
    const isNameValid = validateName();
    const isEmailValid = validateEmail();
    const isPhoneValid = validatePhone();
    const isQuantitiesValid = validateQuantities();
    const isTermsValid = validateTerms();

    if (!isNameValid || !isEmailValid || !isPhoneValid || !isQuantitiesValid || !isTermsValid) {
      return;
    }

    // Collect data
    const name = form.name.value.trim();
    const email = form.email.value.trim();
    const phone = form.phone.value.trim();
    const ytSubs = parseInt(form.ytSubs.value) || 0;
    const ttFollowersBasic = parseInt(form.ttFollowersBasic.value) || 0;
    const ttFollowersPremium = parseInt(form.ttFollowersPremium.value) || 0;
    const ttViews = parseInt(form.ttViews.value) || 0;
    const customOrder = form.customOrder.value.trim();

    if (ytSubs === 0 && ttFollowersBasic === 0 && ttFollowersPremium === 0 && ttViews === 0 && customOrder === '') {
      alert('Please select at least one package or enter a custom order request.');
      return;
    }

    // Prices
    const priceYT = 850;
    const priceTTFBasic = 450;
    const priceTTFPremium = 750;
    const priceTTViews = 300;

    let total = 0;
    let details = '';

    if (ytSubs > 0) {
      total += ytSubs * priceYT;
      details += `YouTube Subscribers (Guaranteed): ${ytSubs} x Rs. ${priceYT} = Rs. ${ytSubs * priceYT}\n`;
    }
    if (ttFollowersBasic > 0) {
      total += ttFollowersBasic * priceTTFBasic;
      details += `TikTok Followers (Basic - NOT Guaranteed): ${ttFollowersBasic} x Rs. ${priceTTFBasic} = Rs. ${ttFollowersBasic * priceTTFBasic}\n`;
    }
    if (ttFollowersPremium > 0) {
      total += ttFollowersPremium * priceTTFPremium;
      details += `TikTok Followers (Premium - Guaranteed): ${ttFollowersPremium} x Rs. ${priceTTFPremium} = Rs. ${ttFollowersPremium * priceTTFPremium}\n`;
    }
    if (ttViews > 0) {
      total += ttViews * priceTTViews;
      details += `TikTok Views (10K packs): ${ttViews} x Rs. ${priceTTViews} = Rs. ${ttViews * priceTTViews}\n`;
    }
    if (customOrder) {
      details += `Custom Order Request:\n${customOrder}\n`;
    }

    // Create order number
    let orderNumParts = [];
    if (ytSubs > 0) orderNumParts.push(`yt-${ytSubs}k`);
    if (ttFollowersBasic > 0) orderNumParts.push(`ttb-${ttFollowersBasic}k`);
    if (ttFollowersPremium > 0) orderNumParts.push(`ttp-${ttFollowersPremium}k`);
    if (ttViews > 0) orderNumParts.push(`ttv-${ttViews}k`);
    if (customOrder) orderNumParts.push(`custom`);

    const cleanName = name.replace(/\s+/g, '-').toLowerCase();
    const orderNumber = 'IT-' + orderNumParts.join('-') + '-' + cleanName + '-' + Math.floor(Math.random() * 1000);
    const timestamp = new Date().toISOString();

    // Prepare order data for Firebase
    orderData = {
      orderNumber,
      name,
      email,
      phone,
      ytSubs,
      ttFollowersBasic,
      ttFollowersPremium,
      ttViews,
      customOrder,
      total,
      timestamp,
      status: 'pending'
    };

    const message =
      `*Infinity Tech Zone - Official Order*\n\n` +
      `Order Number: ${orderNumber}\n` +
      `Customer: ${name}\n` +
      `Email: ${email}\n` +
      `Phone: ${phone}\n` +
      `Date: ${new Date().toLocaleString()}\n\n` +
      `*Order Details:*\n${details}\n` +
      `*Total: Rs. ${total}*\n\n` +
      `*TERMS AGREED:*\n` +
      `- This order is FINAL and cannot be canceled\n` +
      `- Basic followers (Rs. 450) are NOT guaranteed\n` +
      `- Premium services include 30-day guarantee\n` +
      `- Spam orders will be reported to authorities\n\n` +
      `Payment instructions will be sent shortly. Do NOT share this link.`;

    // WhatsApp send URL (encoded)
    const whatsappPhone = '94722966543';
    whatsappUrl = `https://wa.me/${whatsappPhone}?text=` + encodeURIComponent(message);

    // Show confirmation modal
    modal.classList.add('active');
  });

  confirmBtn.addEventListener('click', () => {
    modal.classList.remove('active');
    
    // Save order to Firebase
    const orderRef = database.ref('orders/' + orderData.orderNumber);
    orderRef.set(orderData)
      .then(() => {
        console.log('Order saved to Firebase:', orderData.orderNumber);
        // Open WhatsApp link in new tab/window
        window.open(whatsappUrl, '_blank');
      })
      .catch((error) => {
        console.error('Error saving order:', error);
        // Still proceed with WhatsApp even if Firebase fails
        window.open(whatsappUrl, '_blank');
      });
    
    // Reset form
    form.reset();
  });

  cancelBtn.addEventListener('click', () => {
    modal.classList.remove('active');
  });

  // Accessibility: close modal on Escape key
  document.addEventListener('keydown', e => {
    if (e.key === "Escape") {
      if (modal.classList.contains('active')) {
        modal.classList.remove('active');
      }
      if (welcomePopup.classList.contains('active')) {
        welcomePopup.classList.remove('active');
        popupOverlay.classList.remove('active');
      }
    }
  });
</script>

</body>
</html>
